Preflight: checking Python dependencies
Starting login_automation at Mon Oct  6 20:14:32 +05 2025
2025-10-06 20:14:32,326 - INFO - âœ… All required environment variables loaded successfully
2025-10-06 20:15:17,966 - INFO - Authentication successful
2025-10-06 20:15:17,967 - INFO - Getting last 20 emails...
2025-10-06 20:15:19,800 - INFO - Retrieved 20 emails
2025-10-06 20:15:19,800 - INFO - Found 3 security code emails after filtering
âœ… Loaded credentials for: info@omadligroup.com
ğŸŒ Login URL: https://app.tidyyoursales.com/
ğŸ¯ Target URL: https://app.tidyyoursales.com/v2/location/wZfvILagnooxcUiLaxyk/reporting/call
ğŸ‘ï¸ Headless mode: True
ğŸŒ Opening login page...
ğŸ“ Filling login credentials...
ğŸ” Submitting login form...
â³ Waiting for OTP verification page...
âœ… OTP verification page loaded
ğŸ“¤ Clicking 'Send Security Code' button...
âœ… Security code sent
â° Waiting 30 seconds for email to arrive...
ğŸ“§ Getting latest OTP from email...
âœ… Latest OTP code found: 513201
ğŸ“§ From: noreply@mg.tidyyourhomes.com
ğŸ“… Received: 2025-10-06T15:14:57Z
ğŸ”¢ Using OTP: 513201
âŒ¨ï¸ Entering OTP code...
âœ… OTP entered successfully
â° Waiting 30 seconds for login processing...
Traceback (most recent call last):
  File "/Users/bro/PROJECTS/callreportcatcher/login_automation.py", line 301, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/bro/PROJECTS/callreportcatcher/login_automation.py", line 293, in main
    success = await login_bot.login_with_otp()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bro/PROJECTS/callreportcatcher/login_automation.py", line 288, in login_with_otp
    await browser.close()
  File "/Users/bro/Library/Python/3.13/lib/python/site-packages/playwright/async_api/_generated.py", line 14234, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bro/Library/Python/3.13/lib/python/site-packages/playwright/_impl/_browser.py", line 241, in close
    raise e
  File "/Users/bro/Library/Python/3.13/lib/python/site-packages/playwright/_impl/_browser.py", line 238, in close
    await self._channel.send("close", None, {"reason": reason})
  File "/Users/bro/Library/Python/3.13/lib/python/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/bro/Library/Python/3.13/lib/python/site-packages/playwright/_impl/_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
Finished with exit code 1 at Mon Oct  6 20:15:24 +05 2025
